# 计算机组成原理 第十四章作业

1. 指令并行性主要受限于哪几个方面？

   指令并行性主要受限于指令之间的相关性。指令之间存在相关性时，流水线就不能完全并行的处理这些指令。常见的相关性有五种：

   **资源相关**：当多条指令同时需要访问某一资源，然而该资源却不支持并发访问时，就会产生资源相关性。例如，在某些计算机中，从内存中读取数据和向内存写回数据这两个操作无法同时进行。这种情况下，一条指令处于取操作数阶段，而下一条指令处于写回阶段时，这两个阶段在流水线中就无法并行执行。

   **过程相关**：如果流水线中出现条件转移指令或者变长指令，就会引发过程相关性问题。为了避免出现页故障的情况，在条件转移指令中，只有在确定是否进行转移之后，才能对条件转移后的指令开始取操作数。在这之前，流水线仅仅能对条件转移目标处的指令执行取指操作。这样一来，流水线的运行速度就会受到影响而变慢。

   **写后读相关**：当一条指令向寄存器或者内存的某个位置写入数据之后，后续的指令需要从该位置读取数据，就形成了先写后读相关。为了确保后一条指令能够读取到正确的数据，必须让后一指令的取操作数阶段在前一指令写回阶段结束之后才能进行，这一限制可能会导致流水线的执行速度降低。

   **写后写相关**：若一条指令向寄存器或者内存的某个位置写入数据之后，后续指令又要继续向该位置写入数据，便产生了写后写相关。为了保证内存或者寄存器中的数据是最后写入的版本，后续指令的写回阶段必须晚于前一指令的写回阶段执行，这种情况可能会使流水线的运行速度变缓。

   **先读后写相关**：当一条指令从寄存器或者内存的某个位置读取数据之后，后续指令要向该位置写入数据，就构成了先读后写相关。为了保证第一条指令读取到的是尚未被修改的数据，前一指令的取操作数阶段必须在后一指令的写回阶段之前执行，这一要求可能会导致流水线的执行速度下降。

2. 下列指令序列，各存在什么相关性，在超标量中是如何解决这些相关性的？

```
  I1: LOAD  R1, X

  I2: ADD  R2, R1

  I3: MUL  R2, R4

  I4: MOVE R4, R5
```

指令I1与指令I2之间存在**写后读相关性**，为了确保指令I2的取操作数阶段在指令I1的写回阶段之后进行，可以采取乱序发射的方式，改变指令的执行顺序；也可以插入与这两条指令均不相关的其他指令，利用其执行时间来调整顺序；或者插入空拍，即让流水线在特定阶段空转一个时钟周期，以此来满足先后顺序的要求。

 指令I2和指令I3之间存在**写后写相关性**，借助寄存器重命名，能够在不降低流水线运行速度的前提下，有效解决该相关性问题。具体而言，通过给不同指令分配不同的寄存器别名，避免了对同一寄存器的写冲突，从而保证流水线的顺畅运行。 

指令I3和指令I4之间存在**读后写相关性**，同样可以运用寄存器重命名的方法。通过重新分配寄存器，使得指令I3读取的寄存器值不受指令I4写操作的影响，进而在不拖慢流水线运行效率的情况下，成功解决这一相关性问题，维持流水线的高效运作。 